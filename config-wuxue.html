<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>武学配置生成器</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
            background-color: #f0f2f5;
            color: #333;
            margin: 0;
            padding: 20px;
        }

        .container {
            display: flex;
            width: 90%;
            max-width: 1200px;
            margin: auto;
            background: #fff;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            overflow: hidden;
        }

        .left-panel {
            padding: 30px;
            flex: 1;
            background-color: #fafafa;
            border-right: 1px solid #e0e0e0;
            max-width: 50%;
        }

        .right-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 45%;
            height: calc(100vh - 40px);
            background-color: #ffffff;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            padding: 30px;
            display: flex;
            flex-direction: column;
            box-sizing: border-box;
        }
        
        h2 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-top: 0;
            margin-bottom: 20px;
        }
        .form-section {
            margin-bottom: 25px;
            padding: 20px;
            background-color: #fdfdfd;
            border: 1px solid #eee;
            border-radius: 8px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            font-weight: 600;
            margin-bottom: 5px;
            color: #555;
        }
        input[type="text"], input[type="number"], select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
            transition: border-color 0.3s;
        }
        input[type="text"]:focus, input[type="number"]:focus, select:focus {
            outline: none;
            border-color: #3498db;
        }
        .radio-group label, .checkbox-group label {
            display: inline-block;
            margin-right: 20px;
            font-weight: normal;
        }
        .radio-group input, .checkbox-group input {
            margin-right: 5px;
        }
        .radio-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }
        .radio-group > div {
            flex: 1;
            min-width: 100px;
        }
        #jsonOutput {
            width: 100%;
            flex-grow: 1;
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-family: 'Courier New', Courier, monospace;
            white-space: pre;
            overflow: auto;
        }
        #copyBtn {
            padding: 12px 25px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
            margin-top: 15px;
            align-self: flex-start;
        }
        #copyBtn:hover {
            background-color: #2980b9;
        }
        #copyBtn:active {
            transform: scale(0.98);
        }
        .toggle-section {
            cursor: pointer;
            user-select: none;
            font-weight: bold;
            color: #34495e;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        .toggle-section input[type="checkbox"] {
            transform: scale(1.3);
        }
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 250px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -125px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* 手机端响应式布局 */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                flex-direction: column;
                width: 100%;
                box-shadow: none;
                border-radius: 0;
                overflow: visible;
            }
            .left-panel {
                max-width: 100%;
                border-right: none;
                border-bottom: 1px solid #e0e0e0;
                margin-bottom: 200px;
            }
            .right-panel {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                top: auto;
                width: 100%;
                height: 200px;
                padding: 10px;
                border-radius: 0;
                box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
            }
            .right-panel h2 {
                display: none; /* 手机端隐藏标题 */
            }
            #jsonOutput {
                padding: 10px;
                font-size: 12px;
            }
            #copyBtn {
                width: 100%;
                margin-top: 10px;
                font-size: 14px;
                align-self: stretch; /* 按钮拉伸至与面板同宽 */
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <div class="left-panel">
            <h2>武学配置生成器</h2>
            <div class="form-section">
                <h3>基本信息</h3>
                <div class="form-group">
                    <label for="id">武学ID <span class="tooltip">(自动同步到ID和Mate)<span class="tooltiptext">此ID将作为JSON的顶级键名，并自动填充"id"和"mate"字段。</span></span></label>
                    <input type="number" id="id" value="3065" oninput="generateJson()">
                </div>
                <div class="form-group">
                    <label>武学类型</label>
                    <div class="radio-group" onchange="generateJson()">
                        <div><input type="radio" name="type" value="1" id="type1"><label for="type1">1 (拳法)</label></div>
                        <div><input type="radio" name="type" value="2" id="type2" checked><label for="type2">2 (剑法)</label></div>
                        <div><input type="radio" name="type" value="3" id="type3"><label for="type3">3 (刀法)</label></div>
                        <div><input type="radio" name="type" value="4" id="type4"><label for="type4">4 (棍法)</label></div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="power">威力 (power)</label>
                    <input type="number" id="power" value="1250" oninput="generateJson()">
                </div>
                <div class="form-group">
                    <label for="mode">攻击方式 (mode)</label>
                    <select id="mode" onchange="generateJson()">
                        <option value="21">21 (随机一个敌人)</option>
                        <option value="22">22 (随机两个敌人)</option>
                        <option value="23">23 (随机三个敌人)</option>
                        <option value="24">24 (相邻两个敌人)</option>
                        <option value="25">25 (相邻三个敌人)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="sb_gd">闪避格挡 (sb_gd)</label>
                    <select id="sb_gd" onchange="generateJson()">
                        <option value="0">0 (可闪避格挡)</option>
                        <option value="1">1 (不可格挡)</option>
                        <option value="2">2 (不可闪避)</option>
                        <option value="3" selected>3 (不可闪避格挡)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="baoji">暴击几率 (baoji)</label>
                    <input type="number" id="baoji" value="5" oninput="generateJson()">
                </div>
                <div class="form-group">
                    <label for="baojiEffect">爆伤数值 (baojiEffect)</label>
                    <input type="number" id="baojiEffect" step="0.1" value="2.5" oninput="generateJson()">
                </div>
                <div class="form-group">
                    <label for="yueLi">阅历比例 (yueLi)</label>
                    <input type="number" id="yueLi" step="0.1" value="96.0" oninput="generateJson()">
                </div>
                <div class="form-group">
                    <label for="star">品级 (star)</label>
                    <select id="star" onchange="generateJson()">
                        <option value="0">0 (?)</option>
                        <option value="1">1 (E)</option>
                        <option value="2">2 (D)</option>
                        <option value="3">3 (C)</option>
                        <option value="4">4 (B)</option>
                        <option value="5">5 (A)</option>
                        <option value="6" selected>6 (S)</option>
                    </select>
                </div>
            </div>

            <div class="form-section">
                <h3>武学描述</h3>
                <div class="form-group">
                    <label for="nick">武学名 (nick)</label>
                    <input type="text" id="nick" placeholder="奥本海睦制作丰氚箱子导致长崎速逝" oninput="generateJson()">
                </div>
                <div class="form-group">
                    <label for="desp">武学描述 (desp)</label>
                    <input type="text" id="desp" placeholder="你知道的，人类的底线不仅仅是欧内该" oninput="generateJson()">
                </div>
                <div class="form-group">
                    <label for="icon">图标 (icon)</label>
                    <input type="number" id="icon" value="3003" oninput="generateJson()">
                </div>
                <div class="form-group">
                    <label for="preSkill">前置武学 (preSkill)</label>
                    <input type="text" id="preSkill" placeholder="逗号分隔，例如：1001,1002" oninput="generateJson()">
                </div>
            </div>

            <div class="form-section">
                <h3>效果描述 (effName/effDesp)</h3>
                <div class="form-group">
                    <label for="effName1">效果1名称</label>
                    <input type="text" id="effName1" placeholder="一次mine够" oninput="generateJson()">
                </div>
                <div class="form-group">
                    <label for="effDesp1">效果1描述</label>
                    <input type="text" id="effDesp1" placeholder="发动陷阱卡一次mine够，无法招架闪避" oninput="generateJson()">
                </div>
                <div class="form-group">
                    <label for="effName2">效果2名称</label>
                    <input type="text" id="effName2" placeholder="母鸡卡卡池帮朋友抽了大保底" oninput="generateJson()">
                </div>
                <div class="form-group">
                    <label for="effDesp2">效果2描述</label>
                    <input type="text" id="effDesp2" placeholder="求生欲望高涨，提升18速度" oninput="generateJson()">
                </div>
                <div class="form-group">
                    <label for="effName4">效果4名称</label>
                    <input type="text" id="effName4" placeholder="五子神人" oninput="generateJson()">
                </div>
                <div class="form-group">
                    <label for="effDesp4">效果4描述</label>
                    <input type="text" id="effDesp4" placeholder="五子神人出手必定伤害两人，自己与观众" oninput="generateJson()">
                </div>
            </div>

            <div class="form-section">
                <div class="toggle-section">
                    <input type="checkbox" id="addBuff" onchange="toggleSection()">
                    <label for="addBuff">添加武学BUFF</label>
                </div>
                <div id="buffGroup" style="display: none;">
                    <div class="form-group">
                        <label for="eEffectFlagSelect">Buff种类 (eEffectFlag)</label>
                        <select id="eEffectFlagSelect" onchange="syncEffectFlag()">
                            <option value="0">0 (无)</option>
                            <option value="2">2 (血)</option>
                            <option value="8">8 (速)</option>
                            <option value="131072">131072 (攻)</option>
                            <option value="131074">131074 (攻血)</option>
                            <option value="131080">131080 (攻速)</option>
                            <option value="131082">131082 (攻速血)</option>
                        </select>
                        <label for="eEffectFlagInput">自定义值 (优先级更高)</label>
                        <input type="number" id="eEffectFlagInput" value="0" oninput="syncEffectFlag()">
                    </div>
                    <div class="form-group">
                        <label>是否眩晕 (yun)</label>
                        <div class="radio-group" onchange="generateJson()">
                            <input type="radio" name="yun" value="true" id="yunTrue"><label for="yunTrue">true</label>
                            <input type="radio" name="yun" value="false" id="yunFalse" checked><label for="yunFalse">false</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>是否混乱 (luan)</label>
                        <div class="radio-group" onchange="generateJson()">
                            <input type="radio" name="luan" value="true" id="luanTrue"><label for="luanTrue">true</label>
                            <input type="radio" name="luan" value="false" id="luanFalse" checked><label for="luanFalse">false</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="jiLv">几率 (jiLv)</label>
                        <input type="number" id="jiLv" value="14" oninput="generateJson()">
                    </div>
                    <div class="form-group">
                        <label for="hp">流血数值 (hp)</label>
                        <input type="number" id="hp" value="0" oninput="generateJson()">
                    </div>
                    <div class="form-group">
                        <label for="powerBuff">减攻数值 (powerBuff)</label>
                        <input type="number" id="powerBuff" value="0" oninput="generateJson()">
                    </div>
                    <div class="form-group">
                        <label for="speedBuff">减速数值 (speedBuff)</label>
                        <input type="number" id="speedBuff" value="0" oninput="generateJson()">
                    </div>
                    <div class="form-group">
                        <label for="round">持续回合数 (round)</label>
                        <input type="number" id="round" value="1" oninput="generateJson()">
                    </div>
                    <div class="form-group">
                        <label for="buffLevel">生效重数 (buffLevel)</label>
                        <input type="number" id="buffLevel" value="4" oninput="generateJson()">
                    </div>
                </div>
            </div>

            <div class="form-section">
                <div class="toggle-section">
                    <input type="checkbox" id="addLevelEffect" onchange="toggleSection()">
                    <label for="addLevelEffect">添加属性加成 (levelEffect)</label>
                </div>
                <div id="levelEffectGroup" style="display: none;">
                    <div class="form-group">
                        <label for="levelEffectRate">生效比例 (rate)</label>
                        <input type="number" id="levelEffectRate" value="100" oninput="generateJson()">
                    </div>
                    <div class="form-group">
                        <label for="levelEffectParam">关联物品 (param)</label>
                        <input type="number" id="levelEffectParam" value="0" oninput="generateJson()">
                    </div>
                    <div class="form-group">
                        <label for="levelEffectConsume">消耗次数 (consume)</label>
                        <input type="number" id="levelEffectConsume" value="0" oninput="generateJson()">
                    </div>
                    <div class="form-group">
                        <label for="levelEffectConsumeCount">消耗量 (consumeCount)</label>
                        <input type="number" id="levelEffectConsumeCount" value="0" oninput="generateJson()">
                    </div>
                    <div class="form-group">
                        <label for="levelEffectT">属性类型 (t)</label>
                        <select id="levelEffectT" onchange="generateJson()">
                            <option value="1">1 (绝对血量)</option>
                            <option value="2">2 (血量)</option>
                            <option value="4" selected>4 (速度)</option>
                            <option value="16">16 (闪避)</option>
                            <option value="64">64 (格挡)</option>
                            <option value="512">512 (拳脚威力)</option>
                            <option value="2048">2048 (刀法威力)</option>
                            <option value="8192">8192 (剑法威力)</option>
                            <option value="65536">65536 (绝对攻击)</option>
                            <option value="131072">131072 (攻击)</option>
                            <option value="524288">524288 (免伤)</option>
                            <option value="2097152">2097152 (吸血)</option>
                            <option value="8388608">8388608 (回血)</option>
                            <option value="16777216">16777216 (爆伤)</option>
                            <option value="33554432">33554432 (反伤)</option>
                            <option value="134217728">134217728 (暴击)</option>
                            <option value="134217734">134217734 (武器万分比)</option>
                            <option value="134217735">134217735 (基础伤害万分比)</option>
                            <option value="134217736">134217736 (武功万分比)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="levelEffectV">具体数值 (v)</label>
                        <input type="number" id="levelEffectV" value="18" oninput="generateJson()">
                    </div>
                    <div class="form-group">
                        <label for="levelEffectR">回合数 (r)</label>
                        <input type="number" id="levelEffectR" value="0" oninput="generateJson()">
                    </div>
                    <div class="form-group">
                        <label for="levelEffectLev">生效重数 (levelEffectLev)</label>
                        <input type="number" id="levelEffectLev" value="8" oninput="generateJson()">
                    </div>
                </div>
            </div>

            <div class="form-section">
                <div class="toggle-section">
                    <input type="checkbox" id="addAdMode" onchange="toggleSection()">
                    <label for="addAdMode">添加额外攻击方式 (adMode)</label>
                </div>
                <div id="adModeGroup" style="display: none;">
                    <div class="form-group">
                        <label for="adMode">攻击方式 (adMode)</label>
                        <select id="adMode" onchange="generateJson()">
                            <option value="21">21 (随机一个敌人)</option>
                            <option value="22" selected>22 (随机两个敌人)</option>
                            <option value="23">23 (随机三个敌人)</option>
                            <option value="24">24 (相邻两个敌人)</option>
                            <option value="25">25 (相邻三个敌人)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="adModePercent">生效概率 (adModePercent)</label>
                        <input type="number" id="adModePercent" value="100" oninput="generateJson()">
                    </div>
                    <div class="form-group">
                        <label for="adModeLevel">生效重数 (adModeLevel)</label>
                        <input type="number" id="adModeLevel" value="9" oninput="generateJson()">
                    </div>
                </div>
            </div>

            <div class="form-section">
                <div class="toggle-section">
                    <input type="checkbox" id="addGoodEquip" onchange="toggleSection()">
                    <label for="addGoodEquip">添加适配武器增幅 (goodEquip)</label>
                </div>
                <div id="goodEquipGroup" style="display: none;">
                    <div class="form-group">
                        <label for="goodEquip">适配武器ID (goodEquip)</label>
                        <input type="number" id="goodEquip" value="5853" oninput="generateJson()">
                    </div>
                    <div class="form-group">
                        <label for="goodEquipEffT">属性类型 (t)</label>
                        <select id="goodEquipEffT" onchange="generateJson()">
                            <option value="1">1 (绝对血量)</option>
                            <option value="2">2 (血量)</option>
                            <option value="4">4 (速度)</option>
                            <option value="16">16 (闪避)</option>
                            <option value="64">64 (格挡)</option>
                            <option value="512">512 (拳脚威力)</option>
                            <option value="2048">2048 (刀法威力)</option>
                            <option value="8192">8192 (剑法威力)</option>
                            <option value="65536">65536 (绝对攻击)</option>
                            <option value="131072">131072 (攻击)</option>
                            <option value="524288">524288 (免伤)</option>
                            <option value="2097152">2097152 (吸血)</option>
                            <option value="8388608">8388608 (回血)</option>
                            <option value="16777216">16777216 (爆伤)</option>
                            <option value="33554432">33554432 (反伤)</option>
                            <option value="134217728" selected>134217728 (暴击)</option>
                            <option value="134217734">134217734 (武器万分比)</option>
                            <option value="134217735">134217735 (基础伤害万分比)</option>
                            <option value="134217736">134217736 (武功万分比)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="goodEquipEffV">具体数值 (v)</label>
                        <input type="number" id="goodEquipEffV" value="12" oninput="generateJson()">
                    </div>
                    <div class="form-group">
                        <label for="goodEquipEffR">回合数 (r)</label>
                        <input type="number" id="goodEquipEffR" value="0" oninput="generateJson()">
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="right-panel">
        <h2>JSON 输出</h2>
        <pre id="jsonOutput"></pre>
        <button id="copyBtn" onclick="copyJson()">一键复制</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const sections = [
                { checkbox: 'addBuff', group: 'buffGroup' },
                { checkbox: 'addLevelEffect', group: 'levelEffectGroup' },
                { checkbox: 'addAdMode', group: 'adModeGroup' },
                { checkbox: 'addGoodEquip', group: 'goodEquipGroup' }
            ];

            // 初始隐藏所有可选模块
            sections.forEach(s => {
                document.getElementById(s.group).style.display = 'none';
            });
            
            // 绑定所有输入和选择事件，确保实时更新
            const allInputs = document.querySelectorAll('input, select, textarea');
            allInputs.forEach(element => {
                element.addEventListener('input', generateJson);
                element.addEventListener('change', generateJson);
            });

            // 监听复选框的 change 事件，动态显示/隐藏配置组
            sections.forEach(s => {
                document.getElementById(s.checkbox).addEventListener('change', () => {
                    const isChecked = document.getElementById(s.checkbox).checked;
                    document.getElementById(s.group).style.display = isChecked ? 'block' : 'none';
                    generateJson();
                });
            });

            // 初始化JSON
            generateJson();

            // 阻止 JSON 输出框的滚动穿透
            const jsonOutput = document.getElementById('jsonOutput');
            let startY;
            jsonOutput.addEventListener('touchstart', (e) => {
                startY = e.touches[0].clientY;
            });

            jsonOutput.addEventListener('touchmove', (e) => {
                const deltaY = e.touches[0].clientY - startY;
                const scrollHeight = jsonOutput.scrollHeight;
                const clientHeight = jsonOutput.clientHeight;
                const scrollTop = jsonOutput.scrollTop;

                // 如果已经滚动到顶部并且继续向下拉，或者已经滚动到底部并且继续向上推
                if (
                    (deltaY > 0 && scrollTop === 0) ||
                    (deltaY < 0 && (scrollTop + clientHeight >= scrollHeight))
                ) {
                    e.preventDefault();
                }
            });
        });

        // 同步 Buff 种类选择框和输入框
        function syncEffectFlag() {
            const select = document.getElementById('eEffectFlagSelect');
            const input = document.getElementById('eEffectFlagInput');
            if (document.activeElement === input) {
                select.value = input.value;
            } else if (document.activeElement === select) {
                input.value = select.value;
            }
            generateJson();
        }

        // 生成 JSON 内容
        function generateJson() {
            const id = document.getElementById('id').value;
            const type = document.querySelector('input[name="type"]:checked') ? document.querySelector('input[name="type"]:checked').value : '2';
            const power = document.getElementById('power').value;
            const mode = document.getElementById('mode').value;
            const sb_gd = document.getElementById('sb_gd').value;
            const baoji = document.getElementById('baoji').value;
            const baojiEffect = document.getElementById('baojiEffect').value;
            const yueLi = document.getElementById('yueLi').value;
            const star = document.getElementById('star').value;
            const nick = document.getElementById('nick').value;
            const desp = document.getElementById('desp').value;
            const icon = document.getElementById('icon').value;
            const preSkillInput = document.getElementById('preSkill').value;
            
            const preSkill = preSkillInput ? preSkillInput.split(',').map(s => parseInt(s.trim())).filter(s => !isNaN(s)) : [];

            let data = {
                "type": parseInt(type),
                "power": parseInt(power),
                "speed": 150,
                "mode": parseInt(mode),
                "sb_gd": parseInt(sb_gd),
            };

            // 添加可选的 buff 模块
            if (document.getElementById('addBuff').checked) {
                const eEffectFlag = document.getElementById('eEffectFlagInput').value;
                const yun = document.querySelector('input[name="yun"]:checked').value === 'true';
                const luan = document.querySelector('input[name="luan"]:checked').value === 'true';
                const jiLv = document.getElementById('jiLv').value;
                const hp = document.getElementById('hp').value;
                const powerBuff = document.getElementById('powerBuff').value;
                const speedBuff = document.getElementById('speedBuff').value;
                const round = document.getElementById('round').value;
                const buffLevel = document.getElementById('buffLevel').value;

                data.buff = {
                    "eEffectFlag": parseInt(eEffectFlag),
                    "yun": yun,
                    "luan": luan,
                    "jiLv": parseInt(jiLv),
                    "hp": parseInt(hp),
                    "power": parseInt(powerBuff),
                    "speed": parseInt(speedBuff),
                    "round": parseInt(round)
                };
                data.buffLevel = parseInt(buffLevel);
            }

            // 添加可选的属性加成模块
            if (document.getElementById('addLevelEffect').checked) {
                const rate = document.getElementById('levelEffectRate').value;
                const param = document.getElementById('levelEffectParam').value;
                const consume = document.getElementById('levelEffectConsume').value;
                const consumeCount = document.getElementById('levelEffectConsumeCount').value;
                const t = document.getElementById('levelEffectT').value;
                const v = document.getElementById('levelEffectV').value;
                const r = document.getElementById('levelEffectR').value;
                const levelEffectLev = document.getElementById('levelEffectLev').value;

                data.levelEffect = {
                    "rate": parseInt(rate),
                    "param": parseInt(param),
                    "consume": parseInt(consume),
                    "consumeCount": parseInt(consumeCount),
                    "t": parseInt(t),
                    "v": parseInt(v),
                    "r": parseInt(r)
                };
                data.levelEffectLev = parseInt(levelEffectLev);
            }
            
            // 添加可选的额外攻击方式模块
            if (document.getElementById('addAdMode').checked) {
                const adMode = document.getElementById('adMode').value;
                const adModePercent = document.getElementById('adModePercent').value;
                const adModeLevel = document.getElementById('adModeLevel').value;

                data.adMode = parseInt(adMode);
                data.adModePercent = parseInt(adModePercent);
                data.adModeLevel = parseInt(adModeLevel);
                data.sjEff = `${id}_2`;
            }

            data.baoji = parseFloat(baoji);
            data.baojiEffect = parseFloat(baojiEffect);

            // 添加可选的适配武器增幅模块
            if (document.getElementById('addGoodEquip').checked) {
                const goodEquip = document.getElementById('goodEquip').value;
                const goodEquipEffT = document.getElementById('goodEquipEffT').value;
                const goodEquipEffV = document.getElementById('goodEquipEffV').value;
                const goodEquipEffR = document.getElementById('goodEquipEffR').value;

                data.goodEquip = parseInt(goodEquip);
                data.goodEquipEff = {
                    "t": parseInt(goodEquipEffT),
                    "v": parseInt(goodEquipEffV),
                    "r": parseInt(goodEquipEffR)
                };
            }

            // 添加效果描述
            const effName1 = document.getElementById('effName1').value;
            const effDesp1 = document.getElementById('effDesp1').value;
            if (effName1 || effDesp1) {
                data.effName1 = effName1;
                data.effDesp1 = effDesp1;
            }
            const effName2 = document.getElementById('effName2').value;
            const effDesp2 = document.getElementById('effDesp2').value;
            if (effName2 || effDesp2) {
                data.effName2 = effName2;
                data.effDesp2 = effDesp2;
            }
            const effName4 = document.getElementById('effName4').value;
            const effDesp4 = document.getElementById('effDesp4').value;
            if (effName4 || effDesp4) {
                data.effName4 = effName4;
                data.effDesp4 = effDesp4;
            }

            // 添加其他基础信息
            data.id = parseInt(id);
            data.star = parseInt(star);
            data.nick = nick;
            data.desp = desp;
            data.icon = parseInt(icon);
            data.preSkill = preSkill;
            data.mate = {
                [id]: 1
            };
            
            const output = {};
            output[id] = data;

            document.getElementById('jsonOutput').textContent = JSON.stringify(output, null, 2);
        }

        // 一键复制功能
        function copyJson() {
            const jsonText = document.getElementById('jsonOutput').textContent;
            navigator.clipboard.writeText(jsonText).then(() => {
                const copyBtn = document.getElementById('copyBtn');
                copyBtn.textContent = '已复制!';
                setTimeout(() => {
                    copyBtn.textContent = '一键复制';
                }, 1500);
            }).catch(err => {
                alert('复制失败，请手动复制：' + err);
            });
        }
    </script>

</body>
</html>